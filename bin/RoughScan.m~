function biImage = RoughScan(RawImage)

global Option
threshold = Option.threshold;
R = Option.spotR;
RawImage = double(RawImage);
% high pass filtering to remove uneven background
F = fftshift(fft(RawImage));
F_sub = F;
F_sub(255:259,255:259) = 0;
F_sub(257,257) = F(257,257);

[m,n] = size(filteredImage);
biImage = zeros(m,n);
for i = (R+1):(m-R)
    for j = (R+1):(n-R)
        if filteredImage(i,j) > threshold
            subImage = RawImage(i-R:i+R,j-R:j+R);
            subImage(R+1,R+1) = 0;
            neighborMax = max(max(subImage));
            % If there are two adjacent maximum, only choose one
            if RawImage(i,j) >= neighborMax && sum(sum(biImage(i-1:i+1,j-1:j+1))) < 0.5
                biImage(i,j) = 1;
            end
        end
    end
end
if Option.exclude
    x1 = Option.exclude(1,1);
    y1 = Option.exclude(1,2);
    x2 = Option.exclude(2,1);
    y2 = Option.exclude(2,2);
    biImage(x1:x2,y1:y2) = 0;
end
